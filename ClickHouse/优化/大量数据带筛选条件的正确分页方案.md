```
场景：clickhouse中两千万条记录，需要用查询条件筛选记录，条件命中的条数从几十到几百万不等，然后分页展示筛选到的记录
第一种分页做法：
先根据筛选条件获取满足条件记录的id，并且对id在sql中排序（避免大量数据内存中排序，很慢、很耗性能），取到分页对应的id；再根据id查询对应的记录，此时如果id对应的记录在库中很离散，那么会再次全表遍历；
问题：获取满足条件的所有id会有一次全表扫描，然后因为id分布的很离散，那么在根据id获取具体记录时会再次全表扫描，导致上面的策略很慢；

第二种做法，直接遍历表，查询符合条件的记录（包括id和别的需要的信息），并在内存中排序；
问题：此策略如果命中的记录数很多（大量数据内存中排序，很慢、很耗性能）的话，在内存排序会很费劲

推荐做法：
先查询count，如果数量直接很少采用内存排序的方式，如果命中记录数几千上万，则采用先排序唯一id，再根据id取对应记录的方式

另外说明一点，如果没有查询条件进行筛选（或者筛选条件是索引），并且使用的数据库是mysql，则不必很麻烦；直接按照id（主键）排序，mysql可以从索引树上直接定位记录，不会发生内存中排序的问题
————————————————
版权声明：本文为CSDN博主「深山猿」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。
原文链接：https://blog.csdn.net/h2604396739/article/details/85339087
```

